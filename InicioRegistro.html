<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="InicioRegistro.css">
    <script src="https://kit.fontawesome.com/2542acaf4c.js" crossorigin="anonymous"></script>
    <title>
    </title>
</head>

<body>

<h2></h2>
<div class="container" id="container">
	<div class="form-container sign-up-container">
		<form action="/MascotaPerdida.html" id="registroForm">
            <input type="text" name="nombre" placeholder="Nombre" id="nombre" required>
            <input type="text" name="apellido" placeholder="apellido" id="apellido" required>
            <input type="number" name="edad" placeholder="Edad" id="edad" min="14" max="70" required>
            <input type="number" name="cédula" placeholder="Cédula" id="cedula"  required>
            <input type="text" name="Ciudad" placeholder="Ciudad" id="ciudad" required>
            <input type="text" name="correo" placeholder="correo" id="email" required>
            <input type="password" placeholder="Contraseña" name="password" id="password" required>
			<button type="button" id="registro">Registrate</button>
		</form>
	</div>
	<div class="form-container sign-in-container">
		<form action="MascotaPerdida.html" id="login">
			<h1>Ingresa</h1>
            <div class="social-container">
				<a href="#" class="social"><i class="fa-solid fa-heart"></i>
				<a href="#" class="social"><i class="fa-solid fa-paw"></i>
				<a href="#" class="social"><i class="fa-solid fa-bone"></i>
			</div>
			<span>Ingresa con tu usuario y contraseña</span>
			<input type="text" placeholder="Correo" id="correo" required/>
			<input type="password" placeholder="Contraseña" id="passwordlogin" required/>
			<a href="#">¿Olvidaste tu contraseña?</a>
			<div id="button_inicio"> 
				<button type="button" id="botonIngreso" >Ingresar</button>
			</div>
		</form>
	</div>
	<div class="overlay-container">
		<div class="overlay">
			<div class="overlay-panel overlay-left">
				<h1>Bienvenido!</h1>
                <div class="social-container2">
                    <a href="#" class="social"><i class="fa-solid fa-heart"></i>
                        <a href="#" class="social"><i class="fa-solid fa-paw"></i>
                        <a href="#" class="social"><i class="fa-solid fa-bone"></i>
                </div>
				<p>"Salvar a un perro no cambiará el mundo pero, sin duda, el mundo cambiará para él"</p>
				<button class="ghost" id="signIn"> Ingresa </button>
			</div>
			<div class="overlay-panel overlay-right">
				<h1>!Hola, amigo de dos patas!</h1>
				<p>¿No tienes cuenta? No te preocupes, crea una nueva cuenta en menos de 5 minutos!</p>
				<button class="ghost" id="signUp">Crear nueva cuenta</button>
			</div>
		</div>
	</div>
</div>




<script type="module">
	console.log("todo ok")
	// Import the functions you need from the SDKs you need
	import { initializeApp } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-app.js";
	import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-auth.js";
	import { getDatabase, set,ref, update   } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-database.js";

	// TODO: Add SDKs for Firebase products that you want to use
	// https://firebase.google.com/docs/web/setup#available-libraries
  
	// Your web app's Firebase configuration
	const firebaseConfig = {
	  apiKey: "AIzaSyDnpnXJsxMxn33RV2rPjGMDD1gnwDQD4z0",
	  authDomain: "petfriendly-5a8d3.firebaseapp.com",
	  projectId: "petfriendly-5a8d3",
	  storageBucket: "petfriendly-5a8d3.appspot.com",
	  messagingSenderId: "990910792060",
	  appId: "1:990910792060:web:c71269018d234c4fd5a4f9"
	};
  
	// Initialize Firebase
	const app = initializeApp(firebaseConfig);
	const auth = getAuth();
	const database = getDatabase(app);

    registro.addEventListener('click', (e) =>
	{
	    var nombre = document.getElementById('nombre').value;
		var apellido = document.getElementById('apellido').value;
		var edad = document.getElementById('edad').value;
		var cedula= document.getElementById('cedula').value;
		var ciudad = document.getElementById('ciudad').value;
        var email = document.getElementById('email').value;
		var password = document.getElementById('password').value;

		createUserWithEmailAndPassword(auth, email, password)
  .then((userCredential) => {
    // Signed in
    const user = userCredential.user;
    // ...
	set(ref(database, 'users/' + user.uid), {
	nombre:nombre,
	apellido:apellido,
	edad:edad,
	cedula:cedula,
	ciudad:ciudad,	
    email: email,
    password: password,
    
  })
  .then(() => {
  // Data saved successfully!
  alert('Usuario creado correctamente');

})
.catch((error) => {
  // The write failed...
  alert(error);
});
	
  })
  .catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;
    // ..
	alert(errorMessage);
  });

  document.getElementById('registroForm').reset();
	})

	botonIngreso.addEventListener('click', (e) =>
	{

		var correo= document.getElementById('correo').value;
		var passwordlogin = document.getElementById('passwordlogin').value;

   signInWithEmailAndPassword(auth, correo, passwordlogin)
  .then((userCredential) => {
    // Signed in
    const user = userCredential.user;
    // ...

	var IdDate = new Date();
	update(ref(database, 'users/' + user.uid), {
	 last_login: IdDate,
    
  })
  .then(() => {
  // Data saved successfully!
  location.href ="http://127.0.0.1:5500/RegistroMascota.html";
})
.catch((error) => {
  // The write failed...
  alert(error);
});
  })
  .catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;
	alert(errorMessage);
  });
  document.getElementById('login').reset();
})



  </script>




<script src="./InicioRegistro.js"> </script>


</body>

</html>